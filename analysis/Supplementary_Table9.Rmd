```{r}
library(here)
library(tidyverse)
library(ggplot2)
library(ggpubr)

comps <- list(
    c('WB', 'BRCA'),
    c('WB', 'COAD'),
    c('WB', 'LIHC'),
    c('WB', 'LUAD'),
    c('WB', 'LUSC'),
    c('WB', 'OV'),
    c('WB', 'PAAD')
)

# Calculate for RNA
rna_dat <- readRDS(here('data/giraffe/rna_dat.RDS'))
rna_table <- rna_dat %>%
  distinct() %>%
  group_by(Type) %>%
  summarize(Mean=mean(Expressed.Genes), Standard.Deviation=sd(Expressed.Genes))

# P-values derived from this plot (using ggpubr to calculate stats)
scale <- max(rna_dat$Expressed.Genes) - min(rna_dat$Expressed.Genes)
lab_height <- min(rna_dat$Expressed.Genes) - scale*.05
ggboxplot(rna_dat, x='Type', y='Expressed.Genes', fill='Type', 
        add='jitter') +
    xlab('') +
    ylab('Expressed Genes (count)') +
    theme(legend.position='none') +
    stat_compare_means(comparisons=comps) +
    stat_summary(fun.data=stats_fxn, geom='text', fun.args=lab_height)

# Calculate for beta values first
beta_dat <- readRDS(here('data/giraffe/beta_dat.RDS'))
beta_table <- beta_dat %>%
  distinct() %>%
  group_by(Type) %>%
  summarize(Mean=mean(Methylated.Sites), Standard.Deviation=sd(Methylated.Sites))


# P-values derived from this plot (using ggpubr to calculate stats)
scale <- max(beta_dat$Methylated.Sites) - min(beta_dat$Methylated.Sites)
lab_height <- min(beta_dat$Methylated.Sites) - scale*.05
ggboxplot(beta_dat, x='Type', y='Methylated.Sites', fill='Type', 
        add='jitter') +
    xlab('') +
    ylab('Methylated Sites (count)') +
    theme(legend.position='none') +
    stat_compare_means(comparisons=comps) +
    stat_summary(fun.data=stats_fxn, geom='text', fun.args=lab_height)
```
