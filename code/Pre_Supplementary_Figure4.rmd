---
title: "Pre_Supplementary_Figure4.Rmd"
author: "Michael Noe"
date: "`r Sys.Date()`" 
output:
  workflowr::wflow_html:
    toc: false
editor_options:
  chunk_output_type: console
---


## Prerequisites:

These packages are necessary to process the data to make these figures 

```{r packages, echo=FALSE}
library("tidyverse")
library("here")
```


```{r}
outdir <- here("output", "Pre_Supplementary_Figure4.Rmd")
dir.create(outdir)
dir.create(here(outdir,"healthy_cpggroups"))
```


## Process the data

  *code/healthy_cpggroups.sh* -> outputs "healthy_cpggroups"
    Collect information on fragments starting / ending at CpG's, summarized by motifs around the CpGs and subdivided per CpG-islands, shores, shelves and open sea.
  

## Construct files with metrics of fragment starting and ending around motifs

```{r}
files <- list.files(here(outdir,"healthy_cpggroups"), full.names = T)
t <- tibble()
for (file in files) {
  print(basename(file))
  temp <- readRDS(file)
  t <- rbind(t, temp)
}
t <- t %>% 
  group_by(group, beta, motif) %>%
  summarise(start_all = sum(start), over_all = sum(over))
t$ratio <- t$start_all / t$over_all
saveRDS(t, here("../data/healthy_cpggroups.rds"))
``` 
