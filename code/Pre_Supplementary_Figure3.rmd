---
title: "Pre_Supplementary_Figure3.Rmd"
author: "Michael Noe"
date: "`r Sys.Date()`" 
output:
  workflowr::wflow_html:
    toc: false
editor_options:
  chunk_output_type: console
---


## Prerequisites:

These packages are necessary to process the data to make these figures 

```{r packages, echo=FALSE}
library("tidyverse")
library("here")
```


```{r}
outdir <- here("output", "Pre_Supplementary_Figure3.Rmd")
dir.create(outdir)
dir.create(here(outdir,"diff_startfrags_3bp"))
dir.create(here(outdir,"diff_startfrags_4bp"))
```


## Process the data

  *code/diff_startfrags_3bp.sh* -> outputs "diff_startfrags_3bp"
    Collect information on fragments starting and ending around motifs with a methylated or unmethylated CpG. This script is focused on 3bp-motifs.
  *code/diff_startfrags_4bp.sh* -> outputs "diff_startfrags_4bp"
    Collect information on fragments starting and ending around motifs with a methylated or unmethylated CpG. This script is focused on 4bp-motifs.  


## Construct files with metrics of fragment starting and ending around motifs

```{r}
ls <- list.files(here(outdir,"diff_startfrags_3bp"), full.names = T)
m <- matrix(0,16,51)
for (f in ls) {
  print(basename(f))
  temp <- readRDS(f)
  m <- m + temp
}
saveRDS(m, here("data/diff_startfrags_3bp.rds"))

ls <- list.files(here(outdir,"diff_startfrags_4bp"), full.names = T)
m <- matrix(0,16,51)
for (f in ls) {
  print(basename(f))
  temp <- readRDS(f)
  m <- m + temp
}
saveRDS(m, here("data/diff_startfrags_4bp.rds"))
```
